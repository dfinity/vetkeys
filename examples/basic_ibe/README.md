# Basic Identity Based Encryption

> [!IMPORTANT]  
> These support libraries are under active development and are subject to change. Access to the repositories have been opened to allow for early feedback. Please check back regularly for updates.

The **Basic IBE** example demonstrates how to use **[VetKeys](https://internetcomputer.org/docs/building-apps/network-features/vetkeys/introduction)** to implement secure messaging between users by means of Identity Based Encryption (IBE) on the **Internet Computer (IC)**. This application allows users to send encrypted messages to other users using their **Internet Identity Principal** as the encryption key identifier. This canister (IC smart contract) ensures that only the authorized user can access their private decryption key, meaning that even if someone else knows your principal, they cannot decrypt messages intended for you because neither other users nor this canister can access your private key.

Note that generally it is possible for a canister to request a decryption key to decrypt secrets as part of its code.
However, doing so requires the canister to provide its own transport key instead of requesting a user's transport key and this inherently makes secrets public.
A canister functionality for decrypting secrets can be detected by inspecting the code and, therefore, it is crucial that canisters using VetKeys have their code public to allow to verify that the canister handles secrets in a secure way.

![UI Screenshot](ui_screenshot.png)

## Features

- **Secure Messaging**: Uses IBE capabilities of IC Vetkeys to encrypt messages that can only be decrypted by the intended recipient.
- **Principal-Based Encryption**: Messages are encrypted using the recipient's principal as the public key identifier.
- **Private Key Management**: Each user's private decryption key is generated by the VetKD protocol and encrypted using the user's transport key, making it inaccessible to the canister itself. The canister only sees the keys in encrypted form and forwards them to the authorized users.

## Setup

### Prerequisites

- [Internet Computer software development kit](https://internetcomputer.org/docs/building-apps/getting-started/install)
- [npm](https://www.npmjs.com/package/npm)

### Install Dependencies

```bash
npm install
```

### Deploy the Canisters

Run the local deployment script, which starts the local development environment (`dfx`) if necessary, builds both backend and frontend (asset) canisters, and installs them locally.

If you want to deploy this project with a Motoko backend, then run:
```bash
bash motoko/deploy_locally.sh
```

If you want to deploy this project with a Rust backend, then run:
```bash
bash rust/deploy_locally.sh
```

## Example Components

### Backend

The backend consists of a canister that:
* Stores encrypted messages between users.
* Allows users to retrieve their personal encrypted messages.
* Allows users to retrieve the decryption key for their messages for later decryption in user's browser.

### Frontend

The frontend is a vanilla typescript application providing a simple interface for sending, receiving, and deleting encrypted messages.

To run the frontend in development mode with hot reloading (after running `deploy_locally.sh`):

```bash
npm run dev
```

## Additional Resources

- **[What are VetKeys](https://internetcomputer.org/docs/building-apps/network-features/vetkeys/introduction)** - For more information about VetKeys and VetKD.
